<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft World Map</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""/>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""></script>

    <style>
      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
      }
      html, body {
        height: 100%;
        width: 100vw;
      }
      h4 {
        padding: 0.25em;
        height: 5vh;
      }
      #map_canvas {
        background-color: #000;
        height: 95vh;
        width: 100vw;
        cursor: crosshair;
      }

      img.leaflet-tile {
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;
      }
    </style>
  </head>

  <body>
    <h4>Minecraft World Map</h4>
    <div id="map_canvas"></div>

    <script>

      // minimum zoom level generated by AnvilMapper (eg. 0.0625 with default configuration)
      const anvilMinZoomLevel = 0.25
      // maximum zoom level generated by AnvilMapper (eg. 8 with default configuration)
      const anvilMaxZoomLevel = 1
      // set above according to what folders have been generated in
      // "mods/mamiyaotaru/voxelmap/cache/<worldname>/<dimension>/images"
      // or "voxelmap/cache/<worldname>/<dimension>/images"

      // convert from "scale" syntax (eg. 0.25) to Leaflet "zoom level" syntax (eg. -2)
      const minZoom = Math.log2(anvilMinZoomLevel);
      const maxZoom = Math.log2(anvilMaxZoomLevel);

      var mymap = L.map('map_canvas', {
        crs: L.CRS.Simple,
        zoom: 0,
        center: L.latLng([127, 127]), // x, -y
      });


      /* Path to tile images output by VoxelMap */
      const pathToTileImgs = ``;


      var overworldLayer = L.tileLayer(pathToTileImgs + '/overworld/images/z{myzoom}/{x},{y}.png', {
        myzoom: function(data) {
          /*
            -2 -> 0.25
            -1 -> 0.5
            0 -> 1
            1 -> 2
            2 -> 4
          */
          let calculated = Math.pow(2, data.z);
          return calculated;
        },
        attribution: 'voxelmap',
        minZoom: -4,
        minNativeZoom: minZoom,
        maxZoom: 2,
        maxNativeZoom: maxZoom,
        tileSize: 256
      });
      var netherLayer = L.tileLayer(pathToTileImgs + '/the_nether/images/z{myzoom}/{x},{y}.png', {
        myzoom: function(data) {
          let calculated = Math.pow(2, data.z);
          return calculated;
        },
        attribution: 'voxelmap',
        minZoom: -4,
        minNativeZoom: 0, // to avoid losing detail, since the images are stretched x8
        maxZoom: 2,
        maxNativeZoom: maxZoom,
        tileSize: 2048
      });

      overworldLayer.addTo(mymap);

      L.control.layers({
        "Overworld": overworldLayer,
        "The Nether": netherLayer
      }).addTo(mymap);

    </script>
  </body>
</html>
