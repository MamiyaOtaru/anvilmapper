<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft World Map</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""/>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""></script>

    <style>
      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
      }
      html, body {
        height: 100%;
        width: 100vw;
      }
      h4 {
        padding: 0.25em;
        height: 5vh;
      }
      #map_canvas {
        background-color: #000;
        height: 95vh;
        width: 100vw;
        cursor: crosshair;
      }
    </style>
  </head>

  <body>
    <h4>Minecraft World Map</h4>
    <div id="map_canvas"></div>
    <!-- Right click map to show/hide markers.<br />
    Markers can be created by editing 'index.html'.<br /> -->

    <script>

      // minimum zoom level generated by AnvilMapper (eg. 0.0625 with default configuration)
      const anvilMinZoomLevel = 0.25
      // maximum zoom level generated by AnvilMapper (eg. 8 with default configuration)
      const anvilMaxZoomLevel = 4
      // set above according to what folders have been generated in
      // "mods/mamiyaotaru/voxelmap/cache/<worldname>/<dimension>/images"
      // or "voxelmap/cache/<worldname>/<dimension>/images"

      // convert from "scale" syntax (eg. 0.25) to Leaflet "zoom level" syntax (eg. -2)
      const minZoom = Math.log2(anvilMinZoomLevel);
      const maxZoom = Math.log2(anvilMaxZoomLevel);

      var mymap = L.map('map_canvas', {
        crs: L.CRS.Simple,
        zoom: 0,
        center: L.latLng([127, 127]),
      });


      /* Path to tile images output by VoxelMap */

      const pathToMinecraft = '';
      const pathToVoxelMapOutput = 'voxelmap/cache';
      const worldName = '';

      /* pathToMinecraft should be your path to the .minecraft folder           */
      /* which, depending on the launcher you're using might be in AppData,     */
      /* or when using MultiMC, the path should be to your instance folder, eg. */
      /*   (..)/MultiMC/instances/ExampleInstance/.minecraft                    */

      /* pathToVoxelMapOutput: */
      /* as of VoxelMap v1.10.7 for 1.16.1 the folder is /.minecraft/voxelmap/cache                   */
      /* for versions up to 1.10.1 for 1.16 the folder is /.minecraft/mods/mamiyaotaru/voxelmap/cache */

      /* when on a server, worldName will probably be an IP address with ':' replaced by '~colon~': */
      /*   123.45.67.89~colon~13012                                                                 */

      const pathToTileImgs = `file:///${pathToMinecraft}/${pathToVoxelMapOutput}/${worldName}`;


      L.tileLayer(pathToTileImgs + '/overworld/images/z{myzoom}/{x},{y}.png', {
        myzoom: function(data) {
          /*
            -2 -> 0.25
            -1 -> 0.5
            0 -> 1
            1 -> 2
            2 -> 4
          */
          let calculated = Math.pow(2, data.z);
          console.log(data.z, calculated);
          return calculated;
        },
        attribution: 'me',
        minZoom: -4,
        minNativeZoom: -2,
        maxZoom: 2,
        id: 'overworld',
        tileSize: 256
      }).addTo(mymap);

    </script>
  </body>
</html>
